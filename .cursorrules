# Cursor Rules - Execu√ß√£o Autom√°tica de Planejamentos Aprovados

## üéØ REGRA PRINCIPAL: Execu√ß√£o Autom√°tica

**PLANEJAMENTOS APROVADOS DEVEM SER EXECUTADOS AUTOMATICAMENTE AT√â A PARTE MANUAL**

Quando um planejamento √© aprovado pelo usu√°rio, voc√™ DEVE executar automaticamente seguindo a sequ√™ncia l√≥gica abaixo, SEM perguntar novamente sobre cada etapa.

---

## üìã SEQU√äNCIA L√ìGICA DE EXECU√á√ÉO OBRIGAT√ìRIA

### FASE 1: Atualiza√ß√£o de Contexto e Sistema

#### 1.1 Contexto Global
- ‚úÖ Atualizar `~/Dotfiles/context/global/CONTEXTO_GLOBAL_COMPLETO.md`
- ‚úÖ Atualizar `~/Dotfiles/context/cursor/CONTEXTO_CURSOR.md`
- ‚úÖ Atualizar `~/Dotfiles/context/vscode/CONTEXTO_VSCODE.md`
- ‚úÖ Atualizar `~/Dotfiles/context/claude/CONTEXTO_CLAUDE.md`
- ‚úÖ Atualizar `~/Dotfiles/context/gemini/CONTEXTO_GEMINI.md`
- ‚úÖ Atualizar `~/Dotfiles/context/chatgpt/CONTEXTO_CHATGPT.md`
- ‚úÖ Executar: `~/Dotfiles/scripts/context/update-global-context.sh`

#### 1.2 Sistema e Projetos
- ‚úÖ Verificar e atualizar informa√ß√µes do sistema (macOS/VPS)
- ‚úÖ Validar estrutura de projetos
- ‚úÖ Atualizar `~/Dotfiles/context/global/system-info.json`

### FASE 2: Cofres e Credenciais (1Password)

#### 2.1 Valida√ß√£o de Cofres
- ‚úÖ Verificar vaults dispon√≠veis: `op vault list`
- ‚úÖ Detectar vault correto (1p_macos ‚Üí Personal ‚Üí fallback)
- ‚úÖ Validar autentica√ß√£o: `op whoami`

#### 2.2 Valida√ß√£o de Credenciais
- ‚úÖ Verificar API Keys existentes:
  - `API-VPS-HOSTINGER`
  - `Gemini-API-Keys`
  - `GitHub-Token`
  - `HuggingFace-Token`
  - Outras conforme necess√°rio
- ‚úÖ Validar expira√ß√£o (remover se expiradas)
- ‚úÖ Sincronizar: `~/Dotfiles/scripts/sync/sync-1password-to-dotfiles.sh`

### FASE 3: Terminais e Sistemas

#### 3.1 macOS (Zsh)
- ‚úÖ Validar `~/Dotfiles/scripts/shell/zshrc-macos.sh`
- ‚úÖ Aplicar ao `~/.zshrc` se necess√°rio
- ‚úÖ Verificar vari√°veis de ambiente:
  - `DOTFILES_DIR`
  - `GCP_PROJECT_ID`
  - `HOSTINGER_API_TOKEN`
  - `GOOGLE_API_KEY`
  - `GITHUB_TOKEN`
  - `HF_TOKEN`

#### 3.2 Ubuntu VPS (Bash)
- ‚úÖ Validar `~/Dotfiles/scripts/shell/bashrc-ubuntu.sh`
- ‚úÖ Sincronizar para VPS: `~/Dotfiles/scripts/sync/sync-global-configs.sh vps`
- ‚úÖ Aplicar no VPS via SSH

### FASE 4: IDEs (Cursor e VSCode)

#### 4.1 Cursor 2.0
- ‚úÖ Validar `~/Dotfiles/configs/cursor/settings.json`
- ‚úÖ Validar `~/Dotfiles/configs/cursor/keybindings.json`
- ‚úÖ Aplicar: `~/Dotfiles/scripts/install/cursor.sh`
- ‚úÖ Atualizar contexto Cursor

#### 4.2 VSCode
- ‚úÖ Validar `~/Dotfiles/configs/vscode/settings.json`
- ‚úÖ Validar extens√µes: `~/Dotfiles/configs/extensions/recommended.json`
- ‚úÖ Aplicar configura√ß√µes

### FASE 5: Contexto Global VPS/macOS

#### 5.1 Contexto VPS
- ‚úÖ Validar informa√ß√µes do VPS:
  - IP: 147.79.81.59
  - Dom√≠nio: senamfo.com.br
  - Usu√°rios: root, admin
  - Stack: Coolify, n8n, Chatwoot
- ‚úÖ Atualizar contexto global com informa√ß√µes VPS

#### 5.2 Contexto macOS
- ‚úÖ Validar informa√ß√µes do macOS:
  - Path: `/Users/luiz.sena88/Dotfiles`
  - Shell: zsh
  - Ferramentas: Raycast, Karabiner
- ‚úÖ Atualizar contexto global com informa√ß√µes macOS

### FASE 6: Automa√ß√£o 1Password e GitHub

#### 6.1 1Password
- ‚úÖ Validar CLI instalado: `command -v op`
- ‚úÖ Validar autentica√ß√£o: `op whoami`
- ‚úÖ Validar scripts de automa√ß√£o:
  - `~/Dotfiles/scripts/sync/sync-1password-to-dotfiles.sh`
  - `~/Dotfiles/scripts/governance/setup-oauth-local.sh`
- ‚úÖ Executar sincroniza√ß√£o se necess√°rio

#### 6.2 GitHub
- ‚úÖ Validar CLI instalado: `command -v gh`
- ‚úÖ Validar autentica√ß√£o: `gh auth status`
- ‚úÖ Validar reposit√≥rio: `gh repo view senal88/infraestrutura-vps`
- ‚úÖ Validar secrets e variables configurados
- ‚úÖ Validar workflows GitHub Actions

### FASE 7: Codespaces e DevContainers

#### 7.1 DevContainers
- ‚úÖ Validar `~/Dotfiles/templates/devcontainer/devcontainer.json`
- ‚úÖ Validar `~/Dotfiles/templates/devcontainer/post-create.sh`
- ‚úÖ Validar vari√°veis de ambiente no devcontainer
- ‚úÖ Validar contexto setup: `~/Dotfiles/templates/devcontainer/context-setup.sh`

#### 7.2 GitHub Codespaces
- ‚úÖ Validar `~/Dotfiles/templates/github/workflows/codespace-setup.yml`
- ‚úÖ Validar vari√°veis de ambiente configuradas
- ‚úÖ Validar contexto carregado automaticamente

### FASE 8: MCP Servers

#### 8.1 Valida√ß√£o de MCP Servers
- ‚úÖ Validar `~/Dotfiles/configs/mcp-servers.json`
- ‚úÖ Validar configura√ß√£o Cursor: `~/Dotfiles/configs/mcp/cursor-mcp-servers.json`
- ‚úÖ Validar configura√ß√£o Claude: `~/Dotfiles/configs/mcp/claude-mcp-servers.json`
- ‚úÖ Verificar servidores configurados:
  - `hostinger-mcp` (API Token validado)
  - `filesystem`
  - `git`
  - `github`
  - `docker`
  - Outros conforme necess√°rio

#### 8.2 Teste de MCP Servers
- ‚úÖ Verificar se servidores est√£o acess√≠veis
- ‚úÖ Validar vari√°veis de ambiente dos servidores
- ‚úÖ Testar conex√£o quando poss√≠vel

### FASE 9: APIs e Chaves Validadas

#### 9.1 Valida√ß√£o de API Keys
- ‚úÖ **Gemini**: Validar `GOOGLE_API_KEY` e `GEMINI_API_KEY`
  - Verificar no 1Password: `Gemini-API-Keys`
  - Validar expira√ß√£o (sem necessidade de expira√ß√£o)
  - Testar conex√£o se poss√≠vel

- ‚úÖ **Claude**: Validar autentica√ß√£o e API
  - Verificar configura√ß√£o MCP
  - Validar sem necessidade de expira√ß√£o

- ‚úÖ **Cursor**: Validar configura√ß√£o
  - Verificar settings e keybindings
  - Validar extens√µes

- ‚úÖ **ChatGPT Plus**: Validar API key se configurada
  - Verificar no 1Password
  - Validar sem necessidade de expira√ß√£o

- ‚úÖ **Hostinger**: Validar `HOSTINGER_API_TOKEN`
  - Verificar no 1Password: `API-VPS-HOSTINGER`
  - Testar API: `curl -X GET "https://developers.hostinger.com/api/vps/v1/virtual-machines"`

- ‚úÖ **GitHub**: Validar `GITHUB_TOKEN`
  - Verificar no 1Password
  - Testar: `gh api user`

- ‚úÖ **HuggingFace**: Validar `HF_TOKEN`
  - Verificar no 1Password
  - Validar sem necessidade de expira√ß√£o

#### 9.2 Remo√ß√£o de Chaves Expiradas
- ‚úÖ Identificar chaves expiradas no 1Password
- ‚úÖ Remover chaves obsoletas
- ‚úÖ Atualizar documenta√ß√£o

### FASE 10: Protocolos Validados

#### 10.1 Protocolos de Comunica√ß√£o
- ‚úÖ **SSH**: Validar configura√ß√£o `~/.ssh/config`
  - Aliases: vps, admin-vps, github.com, hf.co
  - Chave: `id_ed25519_universal`
  - Permiss√µes corretas (600 para chaves, 644 para config)

- ‚úÖ **HTTPS/HTTP**: Validar certificados SSL
  - Verificar dom√≠nios: senamfo.com.br, coolify.senamfo.com.br
  - Validar Let's Encrypt se aplic√°vel
  - Testar conectividade HTTPS

- ‚úÖ **Git**: Validar configura√ß√£o
  - Verificar remotes
  - Validar autentica√ß√£o SSH
  - Testar push/pull

#### 10.2 Protocolos de API
- ‚úÖ Validar REST APIs configuradas
- ‚úÖ Validar autentica√ß√£o Bearer Token
- ‚úÖ Validar rate limits e timeouts

### FASE 11: Navegadores e HTTP/HTTPS

#### 11.1 Valida√ß√£o de Navegadores
- ‚úÖ Verificar configura√ß√µes de navegador (se aplic√°vel)
- ‚úÖ Validar extens√µes necess√°rias
- ‚úÖ Validar certificados SSL

#### 11.2 Valida√ß√£o HTTP/HTTPS
- ‚úÖ Testar endpoints principais:
  - `https://senamfo.com.br`
  - `https://coolify.senamfo.com.br`
  - `https://n8n.senamfo.com.br`
  - `https://chatwoot.senamfo.com.br`
- ‚úÖ Validar redirecionamentos HTTP ‚Üí HTTPS
- ‚úÖ Validar certificados SSL v√°lidos

### FASE 12: Melhores Pr√°ticas do Framework

#### 12.1 Nomenclaturas Padronizadas
- ‚úÖ Seguir padr√£o: `<prefixo>-<tipo>-<ambiente>-<versao>-<timestamp>.<extensao>`
- ‚úÖ Prefixos: `op-`, `vps-`, `sys-`, `api-`, `email-`, `db-`, `docker-`, `traefik-`
- ‚úÖ Tipos: `config`, `export`, `diag`, `audit`, `log`, `key`, `mapping`
- ‚úÖ Ambientes: `dev`, `prod`, `macos`, `vps`, `all`

#### 12.2 Estrutura de Diret√≥rios
- ‚úÖ Seguir estrutura padr√£o `~/Dotfiles`
- ‚úÖ Separar: `configs/`, `scripts/`, `credentials/`, `context/`, `docs/`
- ‚úÖ Manter organiza√ß√£o hier√°rquica

#### 12.3 Versionamento
- ‚úÖ Commits com mensagens padronizadas:
  - `feat:` para novas funcionalidades
  - `fix:` para corre√ß√µes
  - `docs:` para documenta√ß√£o
  - `refactor:` para refatora√ß√µes
- ‚úÖ Incluir timestamp e log reference nos commits
- ‚úÖ Seguir framework das aulas com coment√°rios descritivos

#### 12.4 Seguran√ßa
- ‚úÖ NUNCA commitar credenciais
- ‚úÖ Usar 1Password para todas as credenciais
- ‚úÖ Permiss√µes corretas (600 para credenciais, 755 para scripts)
- ‚úÖ Valida√ß√£o de integridade (SHA-256 quando aplic√°vel)

### FASE 13: Documentos Obsoletos Arquivados

#### 13.1 Identifica√ß√£o de Documentos Obsoletos
- ‚úÖ Procurar documentos com data antiga (> 6 meses sem atualiza√ß√£o)
- ‚úÖ Identificar documentos duplicados
- ‚úÖ Identificar documentos substitu√≠dos

#### 13.2 Arquivamento
- ‚úÖ Mover para `~/Dotfiles/docs/archived/` ou `~/10_INFRAESTRUTURA_VPS/documentacao/archived/`
- ‚úÖ Adicionar prefixo `[ARCHIVED]` no nome
- ‚úÖ Adicionar nota de arquivamento no conte√∫do
- ‚úÖ Atualizar refer√™ncias nos documentos ativos

### FASE 14: Acompanhamento Claro de Etapas

#### 14.1 Logging
- ‚úÖ Criar logs em `~/Dotfiles/logs/` ou `~/10_INFRAESTRUTURA_VPS/logs/`
- ‚úÖ Formato: `setup-YYYYMMDD_HHMMSS.log`
- ‚úÖ Incluir timestamp em cada entrada
- ‚úÖ N√≠veis: INFO, SUCCESS, WARNING, ERROR

#### 14.2 Documenta√ß√£o de Progresso
- ‚úÖ Criar `RESUMO_EXECUCAO_YYYYMMDD.md` ap√≥s execu√ß√£o
- ‚úÖ Listar todas as etapas executadas
- ‚úÖ Indicar status de cada etapa (‚úÖ, ‚ùå, ‚ö†Ô∏è)
- ‚úÖ Documentar pr√≥ximos passos manuais

#### 14.3 Status Updates
- ‚úÖ Atualizar status em tempo real durante execu√ß√£o
- ‚úÖ Usar emojis para clareza visual:
  - ‚úÖ Sucesso
  - ‚ùå Erro
  - ‚ö†Ô∏è Aviso
  - üîÑ Em progresso
  - ‚è≥ Pendente

---

## üîí FASE 0: VALIDA√á√ÉO RIGOROSA PR√â-EXECU√á√ÉO (OBRIGAT√ìRIA)

**ESTA FASE DEVE SER EXECUTADA ANTES DE QUALQUER OUTRA FASE**

### 0.1 Valida√ß√£o de Depend√™ncias do Sistema

#### 0.1.1 Ferramentas Obrigat√≥rias
- ‚úÖ **1Password CLI**: `command -v op` ‚Üí DEVE existir e estar autenticado
  - Validar: `op whoami` ‚Üí DEVE retornar usu√°rio v√°lido
  - **ERRO CR√çTICO** se n√£o autenticado ‚Üí PARAR execu√ß√£o

- ‚úÖ **jq**: `command -v jq` ‚Üí DEVE existir
  - **ERRO CR√çTICO** se n√£o instalado ‚Üí PARAR execu√ß√£o

- ‚úÖ **Git**: `command -v git` ‚Üí DEVE existir
  - Validar configura√ß√£o: `git config user.name` e `git config user.email`
  - **ERRO CR√çTICO** se n√£o configurado ‚Üí PARAR execu√ß√£o

- ‚úÖ **SSH**: `command -v ssh` ‚Üí DEVE existir
  - Validar chaves: `~/.ssh/id_ed25519_universal` ‚Üí DEVE existir com permiss√£o 600
  - Validar config: `~/.ssh/config` ‚Üí DEVE existir com permiss√£o 600
  - **ERRO CR√çTICO** se n√£o configurado ‚Üí PARAR execu√ß√£o

- ‚úÖ **curl**: `command -v curl` ‚Üí DEVE existir
  - **ERRO CR√çTICO** se n√£o instalado ‚Üí PARAR execu√ß√£o

#### 0.1.2 Ferramentas Opcionais (Validar mas n√£o bloquear)
- ‚ö†Ô∏è **GitHub CLI**: `command -v gh` ‚Üí Validar se existe
- ‚ö†Ô∏è **Docker**: `command -v docker` ‚Üí Validar se existe
- ‚ö†Ô∏è **Node.js**: `command -v node` ‚Üí Validar se existe

### 0.2 Valida√ß√£o Rigorosa de Vari√°veis e Credenciais no 1Password

#### 0.2.1 Lista de Placeholders INV√ÅLIDOS (REJEITAR IMEDIATAMENTE)

**NUNCA aceitar estes valores como v√°lidos:**

```
- "YOUR_API_KEY"
- "your-api-key-here"
- "placeholder"
- "REPLACE_ME"
- "INSERT_KEY_HERE"
- "example.com"
- "example@example.com"
- "1234567890"
- "changeme"
- "TODO"
- "FIXME"
- "TBD"
- "null"
- "undefined"
- "empty"
- ""
- Qualquer string com menos de 16 caracteres para senhas
- Qualquer string que contenha "example", "test", "demo", "sample"
- Qualquer string que seja apenas n√∫meros sequenciais (12345678)
- Qualquer string que seja apenas letras sequenciais (abcdefgh)
```

#### 0.2.2 Valida√ß√£o de Cada Credencial no 1Password

**Para cada credencial, validar:**

1. **Exist√™ncia**: Item DEVE existir no vault
2. **Campo preenchido**: Campo DEVE ter valor (n√£o vazio)
3. **N√£o √© placeholder**: Valor N√ÉO pode estar na lista de placeholders inv√°lidos
4. **Formato v√°lido**: Valor DEVE seguir formato esperado:
   - API Keys: Geralmente 32+ caracteres alfanum√©ricos
   - Tokens: Geralmente 40+ caracteres
   - Senhas: M√≠nimo 16 caracteres, preferencialmente 32+
   - Emails: Formato v√°lido de email
   - URLs: Formato v√°lido de URL
5. **N√£o expirado**: Se tiver data de expira√ß√£o, DEVE estar v√°lido
6. **√önico**: N√ÉO pode haver duplicatas

#### 0.2.3 Credenciais Obrigat√≥rias e Valida√ß√£o Espec√≠fica

**API-VPS-HOSTINGER**:
- ‚úÖ DEVE existir no vault
- ‚úÖ Valor DEVE ser exatamente `jkBoNklZ2vnWHquuZRjbR09CxmqPfXNOqabkEnJvc06e0665` OU outro token v√°lido
- ‚úÖ N√ÉO pode ser placeholder
- ‚úÖ DEVE ter formato de token Hostinger (64 caracteres alfanum√©ricos)
- ‚úÖ Testar API: `curl -X GET "https://developers.hostinger.com/api/vps/v1/virtual-machines" -H "Authorization: Bearer ${TOKEN}"`
- **ERRO CR√çTICO** se inv√°lido ‚Üí PARAR execu√ß√£o

**Gemini-API-Keys**:
- ‚úÖ DEVE existir no vault
- ‚úÖ Campo `google_api_key` DEVE estar preenchido
- ‚úÖ Valor DEVE ter formato v√°lido (n√£o placeholder)
- ‚úÖ N√ÉO pode conter "example", "test", "demo"
- ‚úÖ DEVE ter pelo menos 32 caracteres
- **ERRO CR√çTICO** se inv√°lido ‚Üí PARAR execu√ß√£o

**GitHub-Token**:
- ‚úÖ DEVE existir no vault (se necess√°rio)
- ‚úÖ Valor DEVE ser token GitHub v√°lido (ghp_... ou ghs_...)
- ‚úÖ N√ÉO pode ser placeholder
- ‚úÖ Testar: `gh api user` ‚Üí DEVE funcionar
- **ERRO CR√çTICO** se inv√°lido e necess√°rio ‚Üí PARAR execu√ß√£o

**HuggingFace-Token**:
- ‚úÖ DEVE existir no vault (se necess√°rio)
- ‚úÖ Valor DEVE ser token HuggingFace v√°lido (hf_...)
- ‚úÖ N√ÉO pode ser placeholder
- **ERRO CR√çTICO** se inv√°lido e necess√°rio ‚Üí PARAR execu√ß√£o

#### 0.2.4 Valida√ß√£o de Vari√°veis de Ambiente

**Para cada vari√°vel de ambiente, validar:**

1. **Definida**: Vari√°vel DEVE estar definida
2. **N√£o vazia**: Valor N√ÉO pode ser vazio
3. **N√£o placeholder**: Valor N√ÉO pode estar na lista de placeholders
4. **Formato correto**: Valor DEVE seguir formato esperado
5. **Acess√≠vel**: Se necess√°rio, testar conectividade/autentica√ß√£o

**Vari√°veis obrigat√≥rias:**
- `DOTFILES_DIR` ‚Üí DEVE apontar para `~/Dotfiles` ou `/Users/luiz.sena88/Dotfiles`
- `GCP_PROJECT_ID` ‚Üí DEVE ser `gcp-ai-setup-24410`
- `GCP_PROJECT_NUMBER` ‚Üí DEVE ser `501288307921`
- `HOSTINGER_API_TOKEN` ‚Üí DEVE ser token v√°lido (n√£o placeholder)
- `GOOGLE_API_KEY` ‚Üí DEVE ser chave v√°lida (n√£o placeholder)
- `GITHUB_TOKEN` ‚Üí DEVE ser token v√°lido se necess√°rio (n√£o placeholder)

### 0.3 Valida√ß√£o de Nomenclaturas e Duplicidades

#### 0.3.1 Valida√ß√£o de Nomenclaturas

**Padr√£o obrigat√≥rio**: `<prefixo>-<tipo>-<ambiente>-<versao>-<timestamp>.<extensao>`

**Validar:**
- ‚úÖ Prefixo DEVE estar na lista v√°lida: `op-`, `vps-`, `sys-`, `api-`, `email-`, `db-`, `docker-`, `traefik-`
- ‚úÖ Tipo DEVE estar na lista v√°lida: `config`, `export`, `diag`, `audit`, `log`, `key`, `mapping`
- ‚úÖ Ambiente DEVE estar na lista v√°lida: `dev`, `prod`, `macos`, `vps`, `all`
- ‚úÖ Vers√£o DEVE seguir padr√£o: `v1`, `v2`, etc.
- ‚úÖ Timestamp DEVE seguir padr√£o: `YYYYMMDD_HHMMSS`

**ERRO** se nomenclatura n√£o seguir padr√£o ‚Üí CORRIGIR antes de continuar

#### 0.3.2 Inspe√ß√£o de Duplicidades

**Para cada arquivo/configura√ß√£o criado:**

1. **Buscar duplicatas**:
   - Procurar arquivos com conte√∫do similar
   - Procurar configura√ß√µes duplicadas
   - Procurar credenciais duplicadas no 1Password

2. **Identificar obsoletos**:
   - Arquivos com data > 6 meses sem atualiza√ß√£o
   - Configura√ß√µes substitu√≠das por vers√µes mais novas
   - Credenciais marcadas como obsoletas

3. **A√ß√µes obrigat√≥rias**:
   - ‚úÖ Remover duplicatas (manter apenas a vers√£o mais recente)
   - ‚úÖ Arquivar obsoletos (mover para `archived/`)
   - ‚úÖ Atualizar refer√™ncias nos documentos ativos
   - ‚úÖ Documentar remo√ß√£o/arquivamento

### 0.4 Valida√ß√£o de Configura√ß√µes e Arquivos

#### 0.4.1 Valida√ß√£o de JSON/YAML

**Para cada arquivo JSON/YAML:**

1. **Sintaxe v√°lida**: Arquivo DEVE ser v√°lido (usar `jq` ou `yq`)
2. **Schema v√°lido**: Se houver schema, DEVE validar contra schema
3. **Campos obrigat√≥rios**: Todos os campos obrigat√≥rios DEVE estar presentes
4. **Tipos corretos**: Valores DEVE ter tipos corretos
5. **Sem placeholders**: Nenhum valor DEVE ser placeholder

**ERRO CR√çTICO** se arquivo inv√°lido ‚Üí CORRIGIR antes de continuar

#### 0.4.2 Valida√ß√£o de Scripts

**Para cada script:**

1. **Sintaxe v√°lida**: Script DEVE ter sintaxe v√°lida (`bash -n script.sh`)
2. **Permiss√µes corretas**: Scripts execut√°veis DEVE ter permiss√£o 755
3. **Shebang correto**: DEVE ter shebang apropriado (`#!/bin/bash`)
4. **Vari√°veis definidas**: Todas as vari√°veis usadas DEVE estar definidas
5. **Sem placeholders**: Nenhum valor hardcoded DEVE ser placeholder

**ERRO CR√çTICO** se script inv√°lido ‚Üí CORRIGIR antes de continuar

### 0.5 Valida√ß√£o de Conectividade e Servi√ßos

#### 0.5.1 Conectividade SSH

- ‚úÖ Testar conex√£o VPS: `ssh -o ConnectTimeout=5 vps "echo OK"`
- ‚úÖ Validar chave SSH: `ssh-add -l` ‚Üí DEVE listar chave
- ‚úÖ Validar config SSH: `~/.ssh/config` ‚Üí DEVE ter aliases corretos
- **ERRO CR√çTICO** se n√£o conecta ‚Üí PARAR execu√ß√£o

#### 0.5.2 Conectividade APIs

**Para cada API necess√°ria:**

1. **Token v√°lido**: Token DEVE ser v√°lido (n√£o placeholder)
2. **Teste de conex√£o**: Fazer requisi√ß√£o de teste
3. **Resposta v√°lida**: API DEVE responder corretamente
4. **Rate limit**: Verificar se n√£o excedeu rate limit

**ERRO CR√çTICO** se API n√£o responde ‚Üí PARAR execu√ß√£o

### 0.6 Valida√ß√£o de Estrutura de Diret√≥rios

**Validar estrutura obrigat√≥ria:**

```
~/Dotfiles/
‚îú‚îÄ‚îÄ configs/          ‚Üí DEVE existir
‚îú‚îÄ‚îÄ scripts/          ‚Üí DEVE existir
‚îú‚îÄ‚îÄ credentials/      ‚Üí DEVE existir (n√£o versionado)
‚îú‚îÄ‚îÄ context/          ‚Üí DEVE existir
‚îî‚îÄ‚îÄ docs/             ‚Üí DEVE existir
```

**ERRO CR√çTICO** se estrutura n√£o existe ‚Üí CRIAR antes de continuar

### 0.7 Checklist de Valida√ß√£o Pr√©-Execu√ß√£o

**ANTES de executar qualquer fase, validar:**

- [ ] Todas as ferramentas obrigat√≥rias instaladas e funcionando
- [ ] Todas as credenciais no 1Password validadas (n√£o placeholders)
- [ ] Todas as vari√°veis de ambiente validadas (n√£o placeholders)
- [ ] Nomenclaturas seguem padr√£o obrigat√≥rio
- [ ] Duplicidades identificadas e removidas
- [ ] Obsoletos identificados e arquivados
- [ ] Todos os arquivos JSON/YAML v√°lidos
- [ ] Todos os scripts v√°lidos e com permiss√µes corretas
- [ ] Conectividade SSH validada
- [ ] Conectividade APIs validada
- [ ] Estrutura de diret√≥rios completa
- [ ] Nenhum placeholder encontrado em nenhum lugar

**SE QUALQUER ITEM FALHAR ‚Üí PARAR execu√ß√£o e CORRIGIR antes de continuar**

---

## üö® REGRAS DE EXECU√á√ÉO

### Regra 0: Valida√ß√£o Rigorosa Pr√©-Execu√ß√£o (CR√çTICA)

**ANTES de executar QUALQUER fase:**

1. **EXECUTAR FASE 0 completa** (valida√ß√£o rigorosa)
2. **N√ÉO continuar** se houver ERROS CR√çTICOS
3. **CORRIGIR** todos os problemas antes de prosseguir
4. **DOCUMENTAR** todas as valida√ß√µes realizadas

**ERROS CR√çTICOS que PARAM execu√ß√£o:**
- ‚ùå Ferramenta obrigat√≥ria n√£o instalada
- ‚ùå Credencial com placeholder no 1Password
- ‚ùå Vari√°vel de ambiente com placeholder
- ‚ùå Arquivo JSON/YAML inv√°lido
- ‚ùå Script com erro de sintaxe
- ‚ùå Conectividade SSH falhando
- ‚ùå API n√£o respondendo (quando necess√°rio)
- ‚ùå Estrutura de diret√≥rios incompleta

### Regra 1: Execu√ß√£o Autom√°tica
Quando um planejamento √© aprovado:
1. **EXECUTAR FASE 0** (valida√ß√£o rigorosa) ‚Üí OBRIGAT√ìRIA
2. **N√ÉO perguntar** sobre cada etapa individual
3. **EXECUTAR automaticamente** seguindo a sequ√™ncia acima
4. **PARAR apenas** quando chegar √† parte manual
5. **DOCUMENTAR** tudo que foi executado

### Regra 2: Valida√ß√£o Obrigat√≥ria
Antes de executar cada fase:
- ‚úÖ Validar pr√©-requisitos
- ‚úÖ Verificar depend√™ncias
- ‚úÖ Confirmar credenciais dispon√≠veis (SEM placeholders)
- ‚úÖ Validar conectividade quando necess√°rio
- ‚úÖ Validar nomenclaturas
- ‚úÖ Verificar duplicidades e obsoletos

### Regra 3: Tratamento de Erros
Se uma etapa falhar:
- ‚úÖ Registrar erro no log
- ‚úÖ Continuar com pr√≥ximas etapas quando poss√≠vel
- ‚úÖ Documentar erro e solu√ß√£o proposta
- ‚úÖ N√£o interromper execu√ß√£o completa a menos que cr√≠tico

### Regra 4: Parte Manual
Quando chegar √† parte manual:
- ‚úÖ Parar execu√ß√£o autom√°tica
- ‚úÖ Documentar claramente o que precisa ser feito manualmente
- ‚úÖ Fornecer instru√ß√µes passo a passo
- ‚úÖ Listar pr√©-requisitos e verifica√ß√µes necess√°rias

---

## üìã CHECKLIST DE EXECU√á√ÉO

Ao executar um planejamento aprovado, seguir esta checklist:

### FASE 0: Valida√ß√£o Rigorosa Pr√©-Execu√ß√£o (OBRIGAT√ìRIA)
- [ ] Ferramentas obrigat√≥rias instaladas e funcionando
- [ ] Credenciais no 1Password validadas (SEM placeholders)
- [ ] Vari√°veis de ambiente validadas (SEM placeholders)
- [ ] Nomenclaturas seguem padr√£o obrigat√≥rio
- [ ] Duplicidades identificadas e removidas
- [ ] Obsoletos identificados e arquivados
- [ ] Arquivos JSON/YAML v√°lidos
- [ ] Scripts v√°lidos e com permiss√µes corretas
- [ ] Conectividade SSH validada
- [ ] Conectividade APIs validada
- [ ] Estrutura de diret√≥rios completa
- [ ] Nenhum placeholder encontrado

### Fases de Execu√ß√£o (ap√≥s FASE 0 validada)
- [ ] FASE 1: Contexto atualizado
- [ ] FASE 2: Cofres validados
- [ ] FASE 3: Terminais configurados
- [ ] FASE 4: IDEs configuradas
- [ ] FASE 5: Contexto global atualizado
- [ ] FASE 6: Automa√ß√£o 1Password/GitHub validada
- [ ] FASE 7: Codespaces/DevContainers validados
- [ ] FASE 8: MCP Servers verificados
- [ ] FASE 9: APIs validadas
- [ ] FASE 10: Protocolos validados
- [ ] FASE 11: Navegadores/HTTP/HTTPS validados
- [ ] FASE 12: Melhores pr√°ticas aplicadas
- [ ] FASE 13: Documentos obsoletos arquivados
- [ ] FASE 14: Acompanhamento documentado

---

## üéØ EXEMPLO DE EXECU√á√ÉO

Quando o usu√°rio aprovar um planejamento:

1. **Iniciar**: "Executando planejamento aprovado automaticamente..."
2. **FASE 1**: Atualizar contexto ‚Üí ‚úÖ Conclu√≠do
3. **FASE 2**: Validar cofres ‚Üí ‚úÖ Conclu√≠do
4. **FASE 3**: Configurar terminais ‚Üí ‚úÖ Conclu√≠do
5. ... (continuar automaticamente)
6. **FASE 14**: Documentar progresso ‚Üí ‚úÖ Conclu√≠do
7. **PARAR**: "Chegamos √† parte manual. Pr√≥ximos passos: [lista]"

---

## ‚ö†Ô∏è IMPORTANTE - REGRAS CR√çTICAS

### Regras Absolutas (NUNCA Violar)

1. **NUNCA aceitar placeholders como v√°lidos**
   - Qualquer valor que seja placeholder ‚Üí REJEITAR imediatamente
   - Qualquer credencial com placeholder ‚Üí ERRO CR√çTICO ‚Üí PARAR execu√ß√£o

2. **NUNCA executar sem valida√ß√£o pr√©via**
   - FASE 0 DEVE ser executada ANTES de qualquer outra fase
   - Se FASE 0 falhar ‚Üí PARAR execu√ß√£o ‚Üí CORRIGIR ‚Üí REPETIR FASE 0

3. **NUNCA ignorar erros cr√≠ticos**
   - Erros cr√≠ticos ‚Üí PARAR execu√ß√£o imediatamente
   - Documentar erro ‚Üí Corrigir ‚Üí Validar novamente ‚Üí Continuar

4. **NUNCA permitir duplicidades ou obsoletos**
   - Duplicidades ‚Üí Remover (manter vers√£o mais recente)
   - Obsoletos ‚Üí Arquivar antes de continuar

5. **NUNCA usar nomenclaturas n√£o padronizadas**
   - Seguir padr√£o obrigat√≥rio: `<prefixo>-<tipo>-<ambiente>-<versao>-<timestamp>.<extensao>`
   - Se n√£o seguir padr√£o ‚Üí CORRIGIR antes de continuar

6. **SEMPRE validar antes de executar**
   - Depend√™ncias ‚Üí Validar antes de usar
   - Credenciais ‚Üí Validar antes de usar
   - Vari√°veis ‚Üí Validar antes de usar
   - Arquivos ‚Üí Validar antes de usar
   - Scripts ‚Üí Validar antes de executar

7. **SEMPRE documentar valida√ß√µes**
   - Todas as valida√ß√µes DEVE ser documentadas
   - Todos os erros DEVE ser documentados
   - Todas as corre√ß√µes DEVE ser documentadas

### Regras de Execu√ß√£o

- **SEMPRE** seguir a sequ√™ncia l√≥gica acima
- **SEMPRE** executar FASE 0 antes de qualquer outra fase
- **NUNCA** pular etapas sem valida√ß√£o
- **SEMPRE** documentar o que foi executado
- **SEMPRE** parar na parte manual com instru√ß√µes claras
- **SEMPRE** usar nomenclaturas padronizadas
- **SEMPRE** seguir melhores pr√°ticas do framework
- **SEMPRE** validar depend√™ncias e vari√°veis antes de usar
- **SEMPRE** inspecionar duplicidades e obsoletos
- **SEMPRE** garantir que nada que possa gerar erros passe desatualizado

---

## üîç EXEMPLO DE VALIDA√á√ÉO RIGOROSA

### Antes de Executar Qualquer Coisa:

```bash
# 1. Validar ferramentas
command -v op || { echo "ERRO CR√çTICO: 1Password CLI n√£o instalado"; exit 1; }
op whoami || { echo "ERRO CR√çTICO: 1Password n√£o autenticado"; exit 1; }

# 2. Validar credencial (SEM placeholder)
TOKEN=$(op read "op://1p_macos/API-VPS-HOSTINGER/credential")
if [[ "$TOKEN" == *"placeholder"* ]] || [[ "$TOKEN" == *"YOUR_"* ]] || [[ -z "$TOKEN" ]]; then
    echo "ERRO CR√çTICO: Credencial cont√©m placeholder ou est√° vazia"
    exit 1
fi

# 3. Testar API
curl -X GET "https://developers.hostinger.com/api/vps/v1/virtual-machines" \
  -H "Authorization: Bearer ${TOKEN}" || {
    echo "ERRO CR√çTICO: API n√£o responde"
    exit 1
}

# 4. Validar nomenclatura
if [[ ! "$filename" =~ ^[a-z]+-[a-z]+-[a-z]+-v[0-9]+-[0-9]{8}_[0-9]{6}\.[a-z]+$ ]]; then
    echo "ERRO: Nomenclatura n√£o segue padr√£o"
    exit 1
fi

# 5. Continuar apenas se todas as valida√ß√µes passarem
echo "‚úÖ Todas as valida√ß√µes passaram. Prosseguindo..."
```

---

**√öltima atualiza√ß√£o**: 2025-11-17
**Vers√£o**: 3.0.0 - Valida√ß√£o Rigorosa e Preven√ß√£o de Erros
